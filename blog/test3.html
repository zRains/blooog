<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>editor å›¾ç‰‡ä¸Šä¼ ç¤ºä¾‹ | zRain</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/blooog/img/logo.svg">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/blooog/assets/css/0.styles.26eb05b9.css" as="style"><link rel="preload" href="/blooog/assets/js/app.13cdbe81.js" as="script"><link rel="preload" href="/blooog/assets/js/3.672fe986.js" as="script"><link rel="preload" href="/blooog/assets/js/1.788aab61.js" as="script"><link rel="preload" href="/blooog/assets/js/12.eefc14c6.js" as="script"><link rel="prefetch" href="/blooog/assets/js/10.1d95f2e3.js"><link rel="prefetch" href="/blooog/assets/js/11.f2759a11.js"><link rel="prefetch" href="/blooog/assets/js/13.fdb43a5b.js"><link rel="prefetch" href="/blooog/assets/js/14.1299086c.js"><link rel="prefetch" href="/blooog/assets/js/15.ef516f20.js"><link rel="prefetch" href="/blooog/assets/js/16.73972e87.js"><link rel="prefetch" href="/blooog/assets/js/4.d20c2fa2.js"><link rel="prefetch" href="/blooog/assets/js/5.eb43b580.js"><link rel="prefetch" href="/blooog/assets/js/6.ee880b0f.js"><link rel="prefetch" href="/blooog/assets/js/7.12853d0e.js"><link rel="prefetch" href="/blooog/assets/js/8.eee7efb2.js"><link rel="prefetch" href="/blooog/assets/js/9.cff6bfbf.js">
    <link rel="stylesheet" href="/blooog/assets/css/0.styles.26eb05b9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="abyss-container"><div class="Navbar"><a href="/blooog/" class="home-link router-link-active"><img src="/blooog/img/logo.svg" alt="zRain" class="logo"> <span>zRain</span></a> <div class="util"></div> <div id="Viewer"><label><span>ğŸŒœ</span> <span>ğŸŒ</span> <input type="checkbox"> <span class="toggle"></span></label></div> <div id="NavLinks"><div class="nav-item"><a href="/blooog/guide" class="nav-link">
  ğŸ“„ è®°å½•å†Œ
</a> <!----></div><div class="nav-item"><a href="/blooog/collect/" class="nav-link">
  ğŸ“‚ æ”¶é›†
</a> <!----></div><div class="nav-item"><!----> <div class="NavDropdownLink"><span>ğŸ“ å·¥å…·</span> <span></span> <div class="dropdown"><a href="/blooog/tool/colorPicker/" class="nav-link">
  ğŸ¨ æ¸è¿›è‰²é€‰å–
</a></div></div></div><div class="nav-item"><!----> <div class="NavDropdownLink"><span>ğŸˆ å¨±ä¹</span> <span></span> <div class="dropdown"><a href="/blooog/language/english/" class="nav-link">
  ğŸŒŒ é›ªèŠ±ç»˜ç”»
</a></div></div></div><div class="nav-item"><!----> <div class="NavDropdownLink"><span>ğŸ§ª å®éªŒæ€§</span> <span></span> <div class="dropdown"><a href="/blooog/language/chinese/" class="nav-link">
  ğŸµ éŸ³ä¹
</a></div></div></div></div></div> <main class="container"><div class="Page"><div class="abyss page-left content__default"><p>å…³äºåšå®¢çš„å±•ç¤ºç»„ä»¶è‡ªå·±é€‰äº†å¥½ä¹…ï¼Œå¦ä¸€ä¸ª<a href="https://github.com/hinesboy/mavonEditor" target="_blank" rel="noopener noreferrer">mavonEditor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¹Ÿä¸é”™ï¼Œä½†æ”¯æŒçš„æ’ä»¶ä¸å¤šï¼Œäºæ˜¯é€‰äº†è¿™ä¸ª<a href="https://github.com/code-farmer-i/vue-markdown-editor" target="_blank" rel="noopener noreferrer"> vue-markdown-editor<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼ˆå‡å›½äº§âœŒï¸ï¼‰ï¼Œæ”¯æŒè‡ªå®šä¹‰é«˜äº®è¯­æ³•åŒ…å’Œæ’ä»¶è‡ªå®šä¹‰ï¼Œæœ€é‡è¦çš„æ˜¯åŒ…å°å•Šã€‚ç ”ç©¶äº†ä¸€ä¸‹å›¾ç‰‡ä¸Šä¼ çš„åŠŸèƒ½ï¼ŒæŒºé¦™çš„ã€‚å®˜æ–¹æ–‡æ¡£æœ‰å®åˆ—ä½†è¿‡äºç®€æ´ã€‚è®°å½•ä¸€ä¸‹ç¼–å†™è¿‡ç¨‹ã€‚</p> <div class="tip coustom_block block"><p class="title">å‰æ</p> <p>æˆ‘ç”¨çš„æ˜¯<strong>Express</strong>æ­å»ºçš„åç«¯ï¼Œä½¿ç”¨<strong>Axios</strong>å‘é€æ•°æ®ã€‚æ¥æ”¶å›¾ç‰‡æ— éå°±æ˜¯æŠŠå‰ç«¯çš„å›¾ç‰‡è¡¨å•æ•°æ®æ‹¿åˆ°ï¼Œåç«¯å†å¤„ç†ä¸€ä¸‹æ•°æ®ä¿å­˜åˆ°ç›¸åº”ä½ç½®ï¼Œæœ€åè¿”å›è·¯å¾„å°±è¡Œäº†ã€‚</p></div> <h4 id="å‡†å¤‡å·¥ä½œ">â˜€ï¸ å‡†å¤‡å·¥ä½œ</h4> <p>ç”±äºåœ¨æ–°ç‰ˆæœ¬<strong>express 4</strong>ä¸­ï¼Œæ–‡ä»¶å¤„ç†<code>req.files</code>ä¸å¯ç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å€ŸåŠ© npm åŒ…æ¥å¤„ç†ä¸Šä¼ çš„å›¾ç‰‡æ•°æ®ï¼Œè¿™é‡Œæˆ‘ä»¬å€ŸåŠ©çš„æ˜¯<code>formidable</code>ã€‚å®‰è£…å‘½ä»¤ï¼š</p> <div class="language-bash extra-class"><div class="highlight-lines"><div class="highlighted">Â </div><br></div><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> formidable -S
</code></pre></div><h4 id="å‰ç«¯">â˜€ï¸ å‰ç«¯</h4> <p>ä¸€ä¸ªç®€å•çš„ä¸Šä¼ è§¦å‘ç»„ä»¶ï¼š</p> <div class="language-vue extra-class"><pre class="language-vue"><code><span class="token comment">&lt;!-- Example --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- æ³¨æ„å¯ç”¨ä¸Šä¼ æœ¬åœ°å›¾ç‰‡åŠŸèƒ½ï¼š:disabled-menus=&quot;[]&quot; --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>v-md-editor</span>
      <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:disabled-menus</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>[]<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">@upload-image</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handleUploadImage<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>v-md-editor</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      content<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">//  filesä¸ºæ–‡ä»¶ä¸Šä¼ çš„æ•°ç»„å¯¹è±¡ï¼Œç”±äºæ˜¯å•ä¸ªå›¾ç‰‡ï¼Œä¸Šä¼ å¯¹è±¡å³ä¸ºfiles[0]</span>
    <span class="token function">handleUploadImage</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> insertImage<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// åˆ›å»ºformå¯¹è±¡</span>
      <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// é€šè¿‡appendå‘formå¯¹è±¡æ·»åŠ æ–‡ä»¶æ•°æ®</span>
      param<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'file'</span><span class="token punctuation">,</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
      <span class="token comment">// å‘é€å›¾ç‰‡æ•°æ®ï¼Œæ³¨æ„é…ç½®è¯·æ±‚å¤´ï¼Œå¦åˆ™åç«¯å¯èƒ½æ— æ³•è¯†åˆ«ã€‚</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$axios
        <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'post'</span><span class="token punctuation">,</span> param<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          headers<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'multipart/form-data'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token comment">// è°ƒç”¨ insertImage å‘ç¼–è¾‘å™¨å†…æ’å…¥å›¾ç‰‡æ•°æ®</span>
          <span class="token function">insertImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            url<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
            desc<span class="token operator">:</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>data<span class="token punctuation">.</span>name<span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="åç«¯">â˜€ï¸ åç«¯</h4> <p>ä¸€ä¸ªç®€å•çš„ä¸Šä¼ æ¥å£ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> formidable <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'formidable'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> cors <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'cors'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// ç”¨corsåšä¸€ä¸‹ç®€å•çš„è·¨åŸŸå¤„ç†</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">{</span> credentials<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> origin<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// å¯åŠ¨expressæœåŠ¡å™¨</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">8081</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'å›¾ç‰‡ä¸Šä¼ æµ‹è¯•æœåŠ¡å™¨'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/api/post'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> form <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">formidable<span class="token punctuation">.</span>IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">// è®¾ç½®ç¼–ç </span>
  form<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span>
  <span class="token comment">// ä¿ç•™æ‰©å±•å</span>
  form<span class="token punctuation">.</span>keepExtensions <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token comment">//æ–‡ä»¶å­˜å‚¨è·¯å¾„ æœ€åè¦æ³¨æ„åŠ  '/' å¦åˆ™ä¼šè¢«å­˜åœ¨imgä¸‹</span>
  form<span class="token punctuation">.</span>uploadDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'/var/www/html/img/imgs/'</span><span class="token punctuation">)</span>
  <span class="token comment">// è§£æ formData æ•°æ®</span>
  form<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> code<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> imgPath <span class="token operator">=</span> files<span class="token punctuation">.</span>file<span class="token punctuation">.</span>path
    <span class="token keyword">let</span> imgName <span class="token operator">=</span> files<span class="token punctuation">.</span>file<span class="token punctuation">.</span>name
    <span class="token comment">// è¿”å›è·¯å¾„å’Œæ–‡ä»¶åï¼Œæ³¨æ„å¤„ç†ä¸€ä¸‹è·¯å¾„ï¼ï¼</span>
    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      code<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> imgName<span class="token punctuation">,</span> path<span class="token operator">:</span> imgPath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">'/var/www/html'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>é‡å¯<strong>Express</strong>å³å¯ã€‚</p> <h4 id="æ–‡ä»¶é‡å‘½åä¸ç§»åŠ¨">â˜€ï¸ æ–‡ä»¶é‡å‘½åä¸ç§»åŠ¨</h4> <p>ç½‘ä¸Šæ•™ç¨‹å¤§å¤šæ•°å°±åˆ°è¿™å„¿å®Œäº†ï¼Œå®é™…ä½¿ç”¨æ—¶å‘ç°è¯¸å¤šä¸ä¾¿ã€‚ä¸Šé¢ä»£ç ä¼šæŠŠæ‰€æœ‰ä¸Šä¼ å›¾ç‰‡å¼„è¿›ä¸€ä¸ªæ–‡ä»¶å¤¹äº†ï¼Œéš¾ä»¥ç®¡ç†ï¼Œä¸”æ–‡ä»¶åéƒ½æ˜¯ç»è¿‡å¤„ç†çš„ã€‚ç”¨å¤šä¸ªæ–‡ä»¶åˆ†å¼€å‚¨å­˜ï¼Œå¹¶ä¿ç•™åŸæœ¬æ–‡ä»¶åä¼šæ›´æ–¹ä¾¿ç®¡ç†ã€‚</p> <h5 id="å‰ç«¯-2">âš¡ï¸ å‰ç«¯</h5> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">handleUploadImage</span><span class="token punctuation">(</span><span class="token parameter">event<span class="token punctuation">,</span> insertImage<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FormData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      param<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">,</span> files<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// å‘è¡¨å•ä¸­æ·»åŠ é¢å¤–çš„æ•°æ®æ–¹ä¾¿åšåˆ†ç±»</span>
      param<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">&quot;article_id&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h5 id="åç«¯-2">âš¡ï¸ åç«¯</h5> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">&quot;/api/post&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> form <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">formidable<span class="token punctuation">.</span>IncomingForm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  form<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">;</span>
  form<span class="token punctuation">.</span>keepExtensions <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  form<span class="token punctuation">.</span>uploadDir <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;./static/images/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  form<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> files</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> code<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> data<span class="token operator">:</span> <span class="token keyword">null</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> imgPath <span class="token operator">=</span> files<span class="token punctuation">.</span>file<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
    <span class="token keyword">let</span> imgName <span class="token operator">=</span> files<span class="token punctuation">.</span>file<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token comment">// é€šè¿‡fieldsè·å–å‰ç«¯ä¼ è¿‡æ¥çš„é¢å¤–æ•°æ®ï¼Œè¿™é‡Œæœ‰ä¸ªå°å‘</span>
    <span class="token comment">// windowsçš„è·¯å¾„åˆ†éš”ç¬¦ä¸º'\'ï¼Œè€Œlinuxçš„ä¸º'/'ã€‚æ³¨æ„ä¸åŒç¯å¢ƒä¸‹çš„ä¹¦å†™</span>
    <span class="token keyword">let</span> folder <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>imgPath<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> fields<span class="token punctuation">.</span>article_id<span class="token punctuation">;</span>
    <span class="token keyword">let</span> newpath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>folder <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> imgName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// fsçš„existså‡½æ•°ç°å·²è¢«åºŸå¼ƒï¼Œè¿™é‡Œç”¨accessåˆ¤æ–­æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨</span>
    fs<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span>folder<span class="token punctuation">,</span> fs<span class="token punctuation">.</span>constants<span class="token punctuation">.</span><span class="token constant">F_OK</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>imgPath<span class="token punctuation">,</span> newpath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// ä¸å­˜åœ¨å…ˆåˆ›å»ºï¼Œå†ç§»åŠ¨æ–‡ä»¶</span>
        fs<span class="token punctuation">.</span><span class="token function">mkdir</span><span class="token punctuation">(</span>folder<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        fs<span class="token punctuation">.</span><span class="token function">rename</span><span class="token punctuation">(</span>imgPath<span class="token punctuation">,</span> newpath<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h4 id="å‚è€ƒæ–‡ç« ">â˜€ï¸ å‚è€ƒæ–‡ç« </h4> <p><a href="https://blog.csdn.net/weixin_34407348/article/details/91466417" target="_blank" rel="noopener noreferrer">express å®ç°å›¾ç‰‡ä¸Šä¼ <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.jianshu.com/p/bd7f11da436f" target="_blank" rel="noopener noreferrer">axios å›¾ç‰‡ä¸Šä¼ <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://www.jianshu.com/p/0a473fdf5f3e" target="_blank" rel="noopener noreferrer">vue é¡¹ç›®ä¸­ä½¿ç”¨ axios ä¸Šä¼ å›¾ç‰‡ç­‰æ–‡ä»¶<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <div class="page-right"><section class="content-info"><div class="title">editor å›¾ç‰‡ä¸Šä¼ ç¤ºä¾‹</div> <div class="tag"><span>å‰ç«¯</span><span>ES5</span></div></section> <section class="content-header"><div>ç›®å½•</div> <div><ul></ul></div></section></div></div> <!----></main> <!----></div><div class="global-ui"></div></div>
    <script src="/blooog/assets/js/app.13cdbe81.js" defer></script><script src="/blooog/assets/js/3.672fe986.js" defer></script><script src="/blooog/assets/js/1.788aab61.js" defer></script><script src="/blooog/assets/js/12.eefc14c6.js" defer></script>
  </body>
</html>
